#######################################################################
# $Header$
#######################################################################

srcdir   = @srcdir@
VPATH    = @srcdir@

SHELL    = /bin/sh
CXX      = @CXX@
CFLAGS   = @CFLAGS@
YACC     = @YACC@
AR       = @AR@
RANLIB   = @RANLIB@

TARGET   = libswig11.a

OBJS     = parser.o main.o scanner.o symbol.o types.o parms.o \
           emit.o cplus.o lang.o hash.o sstring.o wrapfunc.o \
           typemap.o naming.o

SRCS     = main.cxx scanner.cxx symbol.cxx types.cxx parms.cxx \
           emit.cxx cplus.cxx lang.cxx hash.cxx \
           sstring.cxx wrapfunc.cxx typemap.cxx naming.cxx

PARSER   = parser.yxx
INCLUDE  = -I$(srcdir)/../Include               \
           -I$(srcdir)/.                        \
           -I$(srcdir)/../Swig                  \
           -I$(srcdir)/../Preprocessor          \
           -I$(srcdir)/../DOH/Include		\
	   -I../Include

# Rules for creation of a .o file from .cxx
.SUFFIXES: .cxx
.cxx.o:
	$(CXX) $(INCLUDE) $(CFLAGS) -c -o $*.o $<

swig:   $(TARGET)

$(TARGET): $(OBJS)
	$(AR) cr $(TARGET) $(OBJS)
	$(RANLIB) $(TARGET)

parser.o: parser.cxx
	$(CXX) $(INCLUDE) $(CFLAGS) $< -c -o parser.o

parser.cxx: $(PARSER)
	$(YACC) @YFLAGS@ $<
	@cp y.tab.h parser.h
	@cp y.tab.c parser.cxx

parser::
	@cp y.tab.c.bison parser.cxx
	@cp y.tab.h.bison parser.h
	@cp y.tab.h.bison y.tab.h
	$(CXX) $(CFLAGS) parser.cxx -c -o parser.o

clean::
	rm -f *.o $(TARGET) y.tab.c y.tab.h

nuke::
	rm -f Makefile *~ #* core a.out










